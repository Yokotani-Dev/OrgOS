# Work Order: T-OS-015

## Task
- ID: T-OS-015
- Title: Codex CLI 統合 Phase 2: org-implementer に Codex CLI 呼び出しを追加
- Role: implementer

## Allowed Paths
- .claude/commands/org-tick.md（Step 8 のタスク委任セクションを更新）
- .claude/rules/agent-coordination.md（Codex CLI 実行パターンを追加）

## Acceptance Criteria
- org-tick の Step 8 で、codex-implementer タスクが auto_exec: true の場合に Manager が codex exec を自動実行する記述を追加
- agent-coordination.md に Codex CLI 実行パターンを追加（codex exec コマンドの例）
- CONTROL.yaml の codex セクションの説明を充実

## Dependencies
- T-OS-014（Codex CLI 検証）完了済み

## Instructions

### 1. org-tick.md の Step 8 を更新

Step 8.2 の codex-implementer 分岐に、auto_exec: true の場合の処理を追加:

```
auto_exec: true の場合:
1. Work Order を生成
2. codex exec -s <sandbox> -C <worktree_path> "AGENTS.md を読み、<order_file> の指示に従って実行"
3. 結果を .ai/CODEX/RESULTS/<TASK_ID>.md に記録
4. Manager がタスクステータスを更新
```

### 2. agent-coordination.md に Codex CLI パターンを追加

Manager → Codex CLI の呼び出しパターンを追加:

```typescript
// Codex CLI を使った実装
Bash({
  command: `codex exec -s workspace-write -C .worktrees/T-003 "AGENTS.md を読み、.ai/CODEX/ORDERS/T-003.md の指示に従って実行"`,
  run_in_background: true
});
```

### 3. run-parallel.sh のタスクID正規表現を修正

現在 `^T-[0-9]+` のパターンだが、`T-OS-015` のような ID にも対応する必要がある。
`^T-` に変更。

## Reference
- AGENTS.md（必読）
- .ai/CONTROL.yaml の codex セクション
- .claude/scripts/run-parallel.sh
- Phase 1 検証結果: デフォルトモデルは gpt-5.2-codex
