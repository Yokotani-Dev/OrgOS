# レビュー基準

> org-reviewer が使用するコードレビュー判定基準

---

## 重要度レベル

| レベル | 意味 | 対応 |
|--------|------|------|
| 🔴 CRITICAL | セキュリティ脆弱性、データ損失リスク | **即座に修正必須。マージ不可** |
| 🟠 HIGH | バグ、パフォーマンス問題、設計違反 | **修正後に再レビュー** |
| 🟡 MEDIUM | コード品質、可読性、ベストプラクティス | **修正推奨。判断はレビュイーに委ねる** |
| 🟢 LOW | スタイル、命名の提案 | **任意。参考情報** |

---

## CRITICAL（即座に修正必須）

### セキュリティ

- [ ] ハードコードされた認証情報（API キー、パスワード、トークン）
- [ ] SQL インジェクション脆弱性
- [ ] XSS 脆弱性
- [ ] パストラバーサル脆弱性
- [ ] 認証・認可バイパス
- [ ] 機密データの平文保存・送信
- [ ] 不適切なエラーハンドリングによる情報漏洩

### データ整合性

- [ ] データ損失につながる可能性のあるコード
- [ ] トランザクション管理の不備
- [ ] レースコンディション

---

## HIGH（修正後に再レビュー）

### バグリスク

- [ ] null/undefined 未処理
- [ ] 型の不整合
- [ ] エッジケース未対応
- [ ] エラーハンドリング不足

### パフォーマンス

- [ ] N+1 クエリ
- [ ] 不必要な再レンダリング
- [ ] メモリリーク
- [ ] 無限ループの可能性

### 設計違反

- [ ] 50行を超える関数（推奨は20行以下、coding-standards.md 参照）
- [ ] 5つ以上の引数を持つ関数
- [ ] 3レベル以上のネスト
- [ ] 神クラス（責務過多）
- [ ] 循環依存

### テスト

- [ ] カバレッジ 80% 未満
- [ ] クリティカルパスのテスト不足
- [ ] テストなしの新機能

---

## MEDIUM（修正推奨）

### コード品質

- [ ] 20行を超える関数（推奨は20行以下）
- [ ] マジックナンバー
- [ ] 重複コード
- [ ] 複雑な条件分岐
- [ ] console.log 残留

### 可読性

- [ ] 不明瞭な変数名・関数名
- [ ] コメント不足（複雑なロジック）
- [ ] 一貫性のないスタイル

### 最適化

- [ ] useMemo/useCallback の欠如
- [ ] 不必要な依存関係
- [ ] 非効率なアルゴリズム

### ドキュメント

- [ ] 公開 API のドキュメント不足
- [ ] 複雑なビジネスロジックの説明不足

---

## LOW（任意・参考情報）

- [ ] より良い命名の提案
- [ ] コードスタイルの微調整
- [ ] ライブラリの代替案
- [ ] 将来の拡張性の提案

---

## レビュー判定

### ✅ APPROVE（承認）

- CRITICAL: 0件
- HIGH: 0件
- MEDIUM: 判断はレビュイーに委ねる

### ⚠️ REQUEST_CHANGES（修正依頼）

- CRITICAL: 1件以上、または
- HIGH: 1件以上

### 💬 COMMENT（コメントのみ）

- CRITICAL: 0件
- HIGH: 0件
- MEDIUM/LOW のみ

---

## レビュー出力フォーマット

```markdown
## レビュー結果

**判定: ⚠️ REQUEST_CHANGES**

### 🔴 CRITICAL (1件)

1. **src/auth/login.ts:45** - ハードコードされた API キー
   ```typescript
   const apiKey = 'sk-xxxx';  // 環境変数を使用してください
   ```
   → 修正: `process.env.API_KEY` を使用

### 🟠 HIGH (2件)

1. **src/utils/query.ts:23-78** - 関数が55行（50行以下推奨）
   → 提案: 責務ごとに分割

2. **src/components/List.tsx:12** - useEffect 内で無限ループの可能性
   ```typescript
   useEffect(() => {
     setItems([...items, newItem]);  // items が依存配列にない
   }, [newItem]);
   ```
   → 修正: `setItems(prev => [...prev, newItem])` を使用

### 🟡 MEDIUM (1件)

1. **src/hooks/useData.ts:8** - useMemo で最適化可能
   → 提案（任意）: 計算結果をメモ化

---

**次のアクション:**
1. CRITICAL と HIGH を修正
2. 再度レビュー依頼
```

---

## レビュー実施時の心構え

1. **建設的に** - 問題だけでなく解決策も提示
2. **具体的に** - 行番号とコード例を示す
3. **優先度を明確に** - 何が必須で何が任意かを明示
4. **敬意を持って** - コードではなく問題にフォーカス

---

## 参考資料

- [.claude/rules/security.md](security.md) - セキュリティルール
- [.claude/rules/testing.md](testing.md) - テストルール
- [.claude/skills/coding-standards.md](../skills/coding-standards.md) - コーディング規約
