---
description: 対話形式でBRIEF.mdを整形する（プロジェクト開始前のヒアリング）
---

# /org-brief - BRIEF整形コマンド

このコマンドは対話形式で `.ai/BRIEF.md` を作成・更新する。
プロジェクト開始前に Owner と対話し、必要な情報を収集して BRIEF.md に整形する。

---

## 実行フロー

### Step 1: オープンクエスチョン（最初の一言）

**まず自由入力でやりたいことを聞く：**

```
何を作りたいですか？自由に教えてください。
（例：「ECサイトのカート機能」「社内用の勤怠管理ツール」「既存APIのリファクタ」など）
```

この回答を `initial_input` として保持する。

### Step 2: 入力内容の分析

`initial_input` を分析し、以下を推測する：

1. **プロジェクト種別**（Web/Mobile/CLI/API/Library/その他）
2. **対象ユーザー**（エンドユーザー/社内/開発者/自分用）
3. **スコープ感**（新規開発/既存改修/リファクタ）
4. **技術スタック**（言及があれば抽出）
5. **不明確な点**（追加で聞くべきこと）

### Step 3: コンテキストに応じた質問生成

`initial_input` の内容に基づき、AskUserQuestion で適切な質問を生成する。

**質問の原則：**
- 入力で既に明確な項目は聞かない
- 不明確な点、決めるべき点のみ質問
- 選択肢は具体的で、入力内容に関連したものを提示

**質問カテゴリ（必要なものだけ選択）：**

#### A. スコープ確認（入力が曖昧な場合）
```
「〇〇」について、もう少し詳しく教えてください：
- [入力から推測した選択肢A]
- [入力から推測した選択肢B]
- [入力から推測した選択肢C]
```

#### B. マスト要件（必須）
```
リリースに必須の機能・条件は何ですか？
- [入力から推測した機能A]
- [入力から推測した機能B]
- 上記以外にある（入力へ）
```
※ 選択肢は `initial_input` から推測して生成

#### C. 既存資産（関連しそうな場合のみ）
```
流用できる既存資産はありますか？
- 既存コード/リポジトリあり
- デザイン資料あり
- 仕様書/ドキュメントあり
- 特になし
```

#### D. 技術制約（必要な場合のみ）
```
技術的な制約や希望はありますか？
- [入力から推測した技術スタック]を使いたい
- 特定の技術は避けたい
- 特に制約なし
```

#### E. NG事項（スコープが広い場合）
```
今回やらないこと・対象外にすることはありますか？
- [入力から推測したスコープ外候補A]
- [入力から推測したスコープ外候補B]
- 特になし
```

#### F. 期限・優先度
```
期限や優先度はありますか？
- 急ぎ（1週間以内）
- 通常（1ヶ月程度）
- 余裕あり
- 特に決まっていない
```

### Step 4: 追加ヒアリング（必要に応じて）

Step 3 の回答で新たな不明点が出た場合、追加で質問する。
最大2-3ラウンドで収束させる。

### Step 5: BRIEF.md への反映

収集した情報を整形して `.ai/BRIEF.md` に書き込む。

**重要：Ownerの言葉をできるだけそのまま使う**
- 過度に整形・要約しない
- ニュアンスを失わない
- 不明点は「TBD」ではなく「要確認：〇〇」と具体的に

フォーマット例：
```markdown
# BRIEF - プロジェクト概要

> `/org-brief` により対話形式で生成。

---

## 作りたいもの

[initial_input をベースに整形]

---

## マスト要件（Must）

- [収集した要件]

---

## 望ましい要件（Should/Could）

- [あれば記載、なければ「なし」]

---

## 既存資産

- リポジトリ: [URL or なし]
- 既存コード: [パス or なし]
- デザイン: [パス or なし]
- ドキュメント: [パス or なし]
- 参照資料: [パス or なし]

---

## NG事項（やらないこと / 禁止事項）

- [収集した内容 or なし]

---

## 技術制約・希望

- [あれば記載、なければ「特になし」]

---

## 期限 / 優先度

- 期限: [収集した内容]
- 優先度: [高/中/低]

---

## 補足・未決事項

[対話中に出た補足情報や、要確認事項をここに記載]
```

### Step 6: 確認と次のステップ

BRIEF.md の内容をサマリ表示し、**必ず確認を促す**：

```
## BRIEF 作成完了

[作りたいもの の要約を1-2文で]

- マスト要件: [N件]
- 既存資産: [あり/なし]
- 技術制約: [あり/なし]
- 優先度: [高/中/低]

---

⚠️ **確認をお願いします**

📄 **[.ai/BRIEF.md](.ai/BRIEF.md) を開いて内容を確認してください**

BRIEFはプロジェクト全体の方向性を決める最重要ドキュメントです。
ここで認識がずれると、後の作業がすべて無駄になる可能性があります。

確認ポイント：
- 「作りたいもの」の認識は合っていますか？
- マスト要件に漏れはありませんか？
- NG事項（やらないこと）は明確ですか？

---

📌 **次はこちら**

- **修正が必要な場合**: チャットで修正内容を伝える or [.ai/BRIEF.md](.ai/BRIEF.md) を直接編集
- **このまま進める場合**: `/org-start` を実行してプロジェクトを開始
```

**重要：ユーザーが「修正した」または `/org-start` を実行するまで次に進まない。**

---

## 質問生成のガイドライン

**良い質問の例（入力に応じて具体化）：**

入力：「ECサイトのカート機能を作りたい」
→ 質問：「カート機能について確認です」
  - 商品の追加・削除・数量変更
  - 在庫チェック連携
  - ゲスト購入対応
  - 会員限定

入力：「社内の勤怠管理ツール」
→ 質問：「勤怠管理の範囲を教えてください」
  - 出退勤打刻のみ
  - 休暇申請も含む
  - 残業申請も含む
  - 給与計算連携も必要

**避けるべき質問：**
- 入力で既に答えが出ている内容
- 抽象的すぎる質問（「詳しく教えてください」だけ）
- 選択肢が一般的すぎる（入力と無関係）

---

## エラーハンドリング

- `.ai/BRIEF.md` が存在しない場合 → 作成
- 入力が極端に短い場合（「アプリ」など）→ 追加で詳細を聞く
- 中断した場合 → 回答済み部分のみ保存

---

## 注意事項

- このコマンドは `/org-start` の **前に** 実行することを想定
- 対話は日本語で行う
- Ownerの言葉を尊重し、過度な整形を避ける
